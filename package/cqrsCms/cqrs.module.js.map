{"version":3,"sources":["cqrsCms/cqrs.module.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,2CAAsD;AACtD,uCAAyC;AACzC,uCAAgE;AAChE,6CAAgD;AAChD,6DAAyD;AACzD,+DAA2D;AAC3D,uEAAkE;AAClE,uDAAmD;AACnD,uEAAmE;AACnE,2DAAuD;AACvD,8DAA0D;AAC1D,kDAAsD;AACtD,mDAA+C;AAC/C,iDAA6C;AAC7C,gDAAkD;AAClD,gEAA6D;AAC7D,mDAA+C;AAC/C,+DAA2D;AAC3D,iEAA6D;AAC7D,yDAAqD;AA2BrD,IAAa,UAAU,GAAvB;IACI,YACqB,SAAoB,EACpB,QAAoB,EACpB,MAAgB;QAFhB,cAAS,GAAT,SAAS,CAAW;QACpB,aAAQ,GAAR,QAAQ,CAAY;QACpB,WAAM,GAAN,MAAM,CAAU;IAGrC,CAAC;IAED,YAAY;QACR,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC3C,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAEzC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,wBAAa,CAAC,CAAC;QACpC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,0BAAe,CAAC,CAAC;IAE5C,CAAC;CACJ,CAAA;AAjBY,UAAU;IAzBtB,eAAM,CAAC;QACJ,OAAO,EAAE;YACL,iBAAU;YACV,8BAAa;YACb,uBAAa,CAAC,UAAU,CAAC;gBACrB,8BAAa;gBACb,gCAAc;gBACd,wBAAU;gBACV,wCAAkB;gBAClB,uCAAiB;aACpB,CAAC;SACL;QACD,UAAU,EAAE;YACR,gCAAc;YACd,kCAAe;YACf,0BAAW;YACX,4BAAY;YACZ,0BAAW;YACX,+BAAc;YACd,GAAG,0BAAe;YAClB,GAAG,wBAAa;YAChB,sBAAS;YACT,4BAAY;SACf;KACJ,CAAC;qCAGkC,gBAAS;QACV,iBAAU;QACZ,eAAQ;GAJ5B,UAAU,CAiBtB;AAjBY,gCAAU","file":"cqrs.module.js","sourcesContent":["import { Module, OnModuleInit } from \"@nestjs/common\";\nimport { ModuleRef } from \"@nestjs/core\";\nimport { CommandBus, CQRSModule, EventBus } from \"@nestjs/cqrs\";\nimport { TypeOrmModule } from \"@nestjs/typeorm\";\nimport { ArticleEntity } from \"../entity/article.entity\";\nimport { ClassifyEntity } from \"../entity/classify.entity\";\nimport { PageContentEntity } from \"../entity/page.content.entity\";\nimport { PageEntity } from \"../entity/page.entity\";\nimport { PageClassifyEntity } from \"../entity/pageClassify.entity\";\nimport { PagerService } from \"../export/common.paging\";\nimport { SiteMapModule } from \"../sitemap/sitemap.module\";\nimport { CommandHandlers } from \"./commands/handlers\";\nimport { CqrsResolver } from \"./cqrs.resolver\";\nimport { CqrsService } from \"./cqrs.service\";\nimport { EventHandlers } from \"./events/handlers\";\nimport { PageRepository } from \"./repository/pageRepository\";\nimport { PageSagas } from \"./sagas/page.sagas\";\nimport { ArticleService } from \"./service/article.service\";\nimport { ClassifyService } from \"./service/classify.service\";\nimport { PageService } from \"./service/page.service\";\n\n@Module({\n    imports: [\n        CQRSModule,\n        SiteMapModule,\n        TypeOrmModule.forFeature([\n            ArticleEntity,\n            ClassifyEntity,\n            PageEntity,\n            PageClassifyEntity,\n            PageContentEntity,\n        ]),\n    ],\n    components: [\n        ArticleService,\n        ClassifyService,\n        PageService,\n        CqrsResolver,\n        CqrsService,\n        PageRepository,\n        ...CommandHandlers,\n        ...EventHandlers,\n        PageSagas,\n        PagerService,\n    ],\n})\nexport class CqrsModule implements OnModuleInit {\n    constructor(\n        private readonly moduleRef: ModuleRef,\n        private readonly command$: CommandBus,\n        private readonly event$: EventBus,\n        // private readonly PageSagas: PageSagas,\n    ) {\n    }\n\n    onModuleInit() {\n        this.command$.setModuleRef(this.moduleRef);\n        this.event$.setModuleRef(this.moduleRef);\n\n        this.event$.register(EventHandlers);\n        this.command$.register(CommandHandlers);\n        // this.event$.combineSagas([this.PageSagas.articleXml,this.PageSagas.pageXml/*,this.PageSagas.getPages,this.PageSagas.getArticles,this.PageSagas.getClassification*/]);\n    }\n}\n"]}